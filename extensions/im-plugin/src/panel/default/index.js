const _0x1a65=['whether-close','shell','COCOS_DASHBOARD_VERSION','sendSync','file-filter-name',':panel-ready','image','dom-ready','image-filter-name','file-url','send','methods','info-title','info','../../common-lib/translate','callId','select','filePath','#loading-page','dayjs','env','move','Panel','args','jpeg','addEventListener','total','../../common-lib/dialog','none','download-failed','broadcast','guess','downloadProgress',':panel-win-state-changed','template','type','png','is-ready','plugin','paths','./index.html','join','jpg','__esModule','dirname','close','channel','get-data','silent-check','innerText','getTimezoneOffset','kitControl','update','./host-api.js','display','im-plugin','download','new-window','ipcRenderer','addBroadcastListener','close-panel','electron','download-progress','panels','new-msg','update-toolbar','updateBtn','readFileSync','version','style','default','get-sign-in-url-failed','App','loadingPage','#btn-4','fileName','utf8','assign','info-non-logged-in','ipc-message','User','I18n','removeBroadcastListener','download-canceled','ready','get-redirect-url','select-file',':get-version','url','canceled','save-image','removeEventListener','setAttribute','request','transferred',':force-close-panel','getLanguage','@editor/panel/lib/element','select-image','silent-check-and-update','release','Message','gif','refresh','webview','__importDefault','dayjs/plugin/timezone','download-with-progress','isLoggedIn','file-selected','save','click','openExternal','path','request-data','./style.css','beforeClose'];(function(_0x1c3237,_0x5c4d4b){const _0x1a6588=function(_0xd49f16){while(--_0xd49f16){_0x1c3237['push'](_0x1c3237['shift']());}};_0x1a6588(++_0x5c4d4b);}(_0x1a65,0x1d1));const _0xd49f=function(_0x1c3237,_0x5c4d4b){_0x1c3237=_0x1c3237-0xf9;let _0x1a6588=_0x1a65[_0x1c3237];return _0x1a6588;};const _0x111e6f=_0xd49f;'use strict';var __importDefault=this&&this[_0x111e6f(0x165)]||function(_0x2cc77c){return _0x2cc77c&&_0x2cc77c['__esModule']?_0x2cc77c:{'default':_0x2cc77c};};Object['defineProperty'](exports,_0x111e6f(0x127),{'value':!0x0}),exports[_0x111e6f(0x107)]=exports[_0x111e6f(0x129)]=exports[_0x111e6f(0xfb)]=exports[_0x111e6f(0x150)]=exports['$']=exports['style']=exports['template']=void 0x0;const path_1=__importDefault(require('path')),fs_1=__importDefault(require('fs')),electron_1=require(_0x111e6f(0x139)),download_1=__importDefault(require('download')),file_url_1=__importDefault(require(_0x111e6f(0x105))),translate_1=require(_0x111e6f(0x10a)),dialog_1=require(_0x111e6f(0x117)),namespace_1=require('../../constant/namespace'),os_1=__importDefault(require('os')),pluginVersion=electron_1['ipcRenderer'][_0x111e6f(0xff)](namespace_1['ns']+_0x111e6f(0x153));var utc=require('dayjs/plugin/utc'),timezone=require(_0x111e6f(0x166)),dayjs=require(_0x111e6f(0x10f));dayjs['extend'](utc),dayjs['extend'](timezone),module[_0x111e6f(0x123)]['push'](path_1[_0x111e6f(0x142)][_0x111e6f(0x125)](Editor[_0x111e6f(0x144)][_0x111e6f(0x16d)],'./node_modules'));const element=require(_0x111e6f(0x15d)),windowsPkg=require('@base/electron-windows/package.json'),ipcFlag=windowsPkg['name']+'@'+windowsPkg[_0x111e6f(0x140)];let forceClose=!0x1;const template=fs_1[_0x111e6f(0x142)][_0x111e6f(0x13f)](path_1[_0x111e6f(0x142)][_0x111e6f(0x125)](__dirname,_0x111e6f(0x124)),_0x111e6f(0x148));exports[_0x111e6f(0x11e)]=template;const style=fs_1['default'][_0x111e6f(0x13f)](path_1[_0x111e6f(0x142)][_0x111e6f(0x125)](__dirname,_0x111e6f(0xfa)),_0x111e6f(0x148));exports['style']=style;const selector={'webview':'#webview','loadingPage':_0x111e6f(0x10e),'updateBtn':_0x111e6f(0x146)};exports['$']=selector;let action=_0x111e6f(0x163);async function controlUpdateBtn(_0x3dbc8b){const _0x48d3a9=_0x111e6f;await Editor[_0x48d3a9(0x161)][_0x48d3a9(0x159)](_0x48d3a9(0x133),_0x48d3a9(0x12c))?(_0x3dbc8b['$']['updateBtn']['style'][_0x48d3a9(0x132)]='block',_0x3dbc8b['$'][_0x48d3a9(0x13e)][_0x48d3a9(0x12d)]=translate_1['tr']('update-btn')||_0x48d3a9(0x130),_0x3dbc8b['$'][_0x48d3a9(0x13e)][_0x48d3a9(0x115)]('click',async()=>{const _0x186d49=_0x48d3a9;_0x3dbc8b['$'][_0x186d49(0x13e)][_0x186d49(0x141)][_0x186d49(0x132)]=_0x186d49(0x118),Editor['Message']['send'](_0x186d49(0x133),_0x186d49(0x15f));})):(_0x3dbc8b['$']['updateBtn']['style']['display']=_0x48d3a9(0x118),_0x3dbc8b['$'][_0x48d3a9(0x13e)][_0x48d3a9(0x157)](_0x48d3a9(0x16b),()=>{}));}let that=null;async function ready(){const _0x16a81e=_0x111e6f;if(that=this,await controlUpdateBtn(that),forceClose=!0x1,Editor[_0x16a81e(0x112)][_0x16a81e(0x12f)],Editor[_0x16a81e(0x161)][_0x16a81e(0x137)](namespace_1['ns']+_0x16a81e(0x15b),forceClosePanel),!await Editor[_0x16a81e(0x14c)][_0x16a81e(0x168)]())return await dialog_1[_0x16a81e(0x109)](translate_1['tr'](_0x16a81e(0x14a)),{'title':translate_1['tr']('info-title'),'buttons':[translate_1['tr']('ok')],'default':0x0}),void Editor[_0x16a81e(0x161)]['broadcast'](namespace_1['ns']+_0x16a81e(0x15b));this['$'][_0x16a81e(0x164)][_0x16a81e(0x115)](_0x16a81e(0x103),()=>{const _0x361973=_0x16a81e;Editor[_0x361973(0x161)]['send'](namespace_1['ns'],'dom-ready');}),this['$']['webview']['setAttribute']('webpreferences','contextIsolation=false'),this['$'][_0x16a81e(0x164)][_0x16a81e(0x158)]('preload',file_url_1[_0x16a81e(0x142)](path_1[_0x16a81e(0x142)][_0x16a81e(0x125)](__dirname,_0x16a81e(0x131)))),this['$']['webview'][_0x16a81e(0x115)](_0x16a81e(0x14b),_0x36c614=>{const _0x47d1ac=_0x16a81e;onIpcMessage(_0x36c614,this['$'][_0x47d1ac(0x164)],this['$'][_0x47d1ac(0x145)]);});const _0x216e86=await Editor['Message'][_0x16a81e(0x159)](namespace_1['ns'],'get-sign-in-url');if(!_0x216e86)return dialog_1['info'](translate_1['tr'](_0x16a81e(0x143)),{'title':translate_1['tr'](_0x16a81e(0x108))}),void Editor[_0x16a81e(0x161)][_0x16a81e(0x11a)](namespace_1['ns']+_0x16a81e(0x15b));this['$']['webview']['src']=_0x216e86,this['$'][_0x16a81e(0x164)][_0x16a81e(0x115)](_0x16a81e(0x135),async _0x3229ea=>{const _0x4ed6a2=_0x16a81e;electron_1[_0x4ed6a2(0xfd)][_0x4ed6a2(0x16c)](await Editor['Message'][_0x4ed6a2(0x159)](namespace_1['ns'],_0x4ed6a2(0x151),_0x3229ea[_0x4ed6a2(0x154)]));}),electron_1[_0x16a81e(0x136)]['on'](ipcFlag+':close',()=>{action='close';}),electron_1[_0x16a81e(0x136)]['on'](namespace_1['ns']+':panel-win-state-changed',(_0x4f9cd0,_0x2eee88)=>{const _0x5ab32e=_0x16a81e;try{this['$'][_0x5ab32e(0x164)][_0x5ab32e(0x106)](namespace_1['ns']+_0x5ab32e(0x11d),_0x2eee88);}catch(_0xac8a7c){}}),electron_1[_0x16a81e(0x136)][_0x16a81e(0x106)](namespace_1['ns']+_0x16a81e(0x101));}async function beforeClose(_0x378df0={}){const _0x2978f8=_0x111e6f;if(forceClose||_0x378df0[_0x2978f8(0x111)]||element['panels']&&element[_0x2978f8(0x13b)]['length']>0x1)return!0x0;if('refresh'===action)return!0x0;action=_0x2978f8(0x163);try{return!!await Editor['Message'][_0x2978f8(0x159)](namespace_1['ns'],_0x2978f8(0xfc))||(electron_1[_0x2978f8(0x136)]['send'](namespace_1['ns']+':hide-panel'),!0x1);}catch(_0x540de2){return!0x0;}}function close(){const _0xdbf877=_0x111e6f;Editor[_0xdbf877(0x161)][_0xdbf877(0x14e)](namespace_1['ns']+_0xdbf877(0x15b),forceClosePanel);}function onIpcMessage(_0x5dc89b,_0x45fe08,_0x5a5a98){const _0x3f3133=_0x111e6f;async function _0x24b71c(_0x52e674){const _0x151ff8=_0xd49f,_0x592b0d=_0x5dc89b[_0x151ff8(0x113)][0x0][_0x151ff8(0x11f)],_0x5006f8=_0x5dc89b[_0x151ff8(0x113)][0x0][_0x151ff8(0x147)];let _0x29b84c=null;_0x29b84c=_0x151ff8(0x102)===_0x592b0d?{'title':translate_1['tr'](_0x151ff8(0x156)),'path':_0x5006f8,'filters':[{'name':translate_1['tr'](_0x151ff8(0x104)),'extensions':['jpg',_0x151ff8(0x114),_0x151ff8(0x120),_0x151ff8(0x162)]}]}:{'title':translate_1['tr']('save-file'),'path':_0x5006f8,'filters':[{'name':translate_1['tr'](_0x151ff8(0x100)),'extensions':['*']}]};const _0x326869=await dialog_1[_0x151ff8(0x16a)](_0x29b84c);if(!_0x326869[_0x151ff8(0x10d)])return void(_0x52e674&&_0x45fe08[_0x151ff8(0x106)](_0x151ff8(0x14f),_0x5dc89b[_0x151ff8(0x113)][0x0][_0x151ff8(0x10b)]));const _0x59cb02=_0x5dc89b['args'][0x0][_0x151ff8(0x154)],_0x3843fd=path_1['default'][_0x151ff8(0x128)](_0x326869[_0x151ff8(0x10d)]),_0x5a3702=download_1[_0x151ff8(0x142)](_0x59cb02,_0x3843fd,{'filename':path_1[_0x151ff8(0x142)]['basename'](_0x326869['filePath'])});if(_0x52e674){_0x5a3702['on'](_0x151ff8(0x11c),_0x5e5ae9=>{const _0x3a089d=_0x151ff8;_0x45fe08['send'](_0x3a089d(0x13a),{'callId':_0x5dc89b[_0x3a089d(0x113)][0x0]['callId'],'percent':_0x5e5ae9['percent'],'transferred':_0x5e5ae9[_0x3a089d(0x15a)],'total':_0x5e5ae9[_0x3a089d(0x116)]});});try{await _0x5a3702,_0x45fe08['send']('download-succeeded',_0x5dc89b[_0x151ff8(0x113)][0x0][_0x151ff8(0x10b)]);}catch(_0x2a95a9){_0x45fe08['send'](_0x151ff8(0x119),{'callId':_0x5dc89b[_0x151ff8(0x113)][0x0]['callId'],'errorStr':_0x2a95a9['toString']()});}}}switch(_0x5dc89b[_0x3f3133(0x12a)]){case _0x3f3133(0x13c):Editor[_0x3f3133(0x161)]['send'](namespace_1['ns'],_0x3f3133(0x13d),{'newMsgCount':_0x5dc89b['args'][0x0]['newMsgCount']});break;case _0x3f3133(0x121):_0x5a5a98[_0x3f3133(0x141)][_0x3f3133(0x132)]=_0x3f3133(0x118);break;case _0x3f3133(0x134):_0x24b71c(!0x1);break;case _0x3f3133(0x152):!async function(){const _0xf901a3=_0x3f3133,_0x63fd98=await function(){const _0x23a4cc=_0xd49f;let _0x2b288c;return _0x2b288c=_0x23a4cc(0x102)===_0x5dc89b[_0x23a4cc(0x113)][0x0][_0x23a4cc(0x11f)]?{'title':translate_1['tr'](_0x23a4cc(0x15e)),'filters':[{'name':translate_1['tr']('image-filter-name'),'extensions':[_0x23a4cc(0x126),'jpeg',_0x23a4cc(0x120),_0x23a4cc(0x162)]}]}:{'title':translate_1['tr']('select-file'),'filters':[{'name':translate_1['tr'](_0x23a4cc(0x100)),'extensions':['*']}]},dialog_1[_0x23a4cc(0x10c)](_0x2b288c);}();_0x63fd98[_0xf901a3(0x155)]?_0x45fe08[_0xf901a3(0x106)](_0xf901a3(0x169),''):_0x45fe08[_0xf901a3(0x106)](_0xf901a3(0x169),_0x63fd98['filePaths'][0x0]);}();break;case _0x3f3133(0x167):_0x24b71c(!0x0);break;case _0x3f3133(0xf9):!async function(){const _0x554c22=_0x3f3133,_0x3f1ace={'entry':_0x554c22(0x122),'languageType':Editor[_0x554c22(0x14d)][_0x554c22(0x15c)](),'osTimeZone':'UTC'+(-new Date()[_0x554c22(0x12e)]()>=0x0?'+':'')+-new Date()[_0x554c22(0x12e)]()/0x3c+'\x20'+dayjs['tz'][_0x554c22(0x11b)](),'dashBoardVersion':process[_0x554c22(0x110)][_0x554c22(0xfe)],'creatorVersion':Editor[_0x554c22(0x144)][_0x554c22(0x140)],'pluginVersion':pluginVersion,'osType':os_1['default'][_0x554c22(0x11f)](),'osVersion':os_1[_0x554c22(0x142)][_0x554c22(0x160)]()};_0x45fe08['send'](_0x554c22(0x12b),Object[_0x554c22(0x149)]({},_0x3f1ace));}();}}function forceClosePanel(){const _0x4e1f55=_0x111e6f;forceClose=!0x0,Editor[_0x4e1f55(0x161)]['send'](namespace_1['ns'],_0x4e1f55(0x138));}exports[_0x111e6f(0x150)]=ready,exports[_0x111e6f(0xfb)]=beforeClose,exports['close']=close;const methods={async 'check'(){that&&await controlUpdateBtn(that);}};exports[_0x111e6f(0x107)]=methods;