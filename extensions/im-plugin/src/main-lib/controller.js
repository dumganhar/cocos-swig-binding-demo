const _0x812c=['getInstance','onHidePanel','uninit','onUserLogout',':panel-ready','contributions','updateToolbar','init','setPanelBlurred','ipcMain','focus','broadcast','getButtonTitle','onNotLoggedInState','path','isVip','shouldShowEntrance','apply','show','__esModule','onLoggedInShouldNotShowState','cleanUp','add','defineProperty','hide','remove','addBroadcastListener','fromWebContents','User','send','onClosePanel','onLanguageChanged','Message','i18n:change','default','BrowserWindow',':panel-win-state-changed','getPackages','onShowPanel','name','Menu','assign','instance','../constant/namespace','info','setMenuVisibility','isLoggedIn','minimize','onPanelReady',':force-close-panel','dispatchLoggedInState','login','blur','length','onUserLogin','removeListener','panel\x20window\x20is\x20undefined','menu','removeBroadcastListener','logout','bind','sender','Package','restore','onLoggedInShouldShowState','electron','./service'];(function(_0x18c7a4,_0x86ce72){const _0x812cab=function(_0xcfe8d6){while(--_0xcfe8d6){_0x18c7a4['push'](_0x18c7a4['shift']());}};_0x812cab(++_0x86ce72);}(_0x812c,0x194));const _0xcfe8=function(_0x18c7a4,_0x86ce72){_0x18c7a4=_0x18c7a4-0x12c;let _0x812cab=_0x812c[_0x18c7a4];return _0x812cab;};const _0x1ab6de=_0xcfe8;'use strict';var __importDefault=this&&this['__importDefault']||function(_0x423789){const _0x12b502=_0xcfe8;return _0x423789&&_0x423789[_0x12b502(0x13d)]?_0x423789:{'default':_0x423789};};Object[_0x1ab6de(0x141)](exports,_0x1ab6de(0x13d),{'value':!0x0});const path_1=__importDefault(require('path')),electron_1=require(_0x1ab6de(0x16b)),update_toolbar_1=require('../common-lib/update-toolbar'),namespace_1=require(_0x1ab6de(0x155)),new_msg_count_timer_1=__importDefault(require('./new-msg-count-timer')),service_1=__importDefault(require(_0x1ab6de(0x16c))),newMsgCountTimer=new_msg_count_timer_1[_0x1ab6de(0x14c)]['getInstance']();class Controller{constructor(){const _0x3a4527=_0x1ab6de;this[_0x3a4527(0x160)]=this['onUserLogin'][_0x3a4527(0x166)](this),this[_0x3a4527(0x12d)]=this[_0x3a4527(0x12d)][_0x3a4527(0x166)](this),this['onLanguageChanged']=this[_0x3a4527(0x149)]['bind'](this),this[_0x3a4527(0x15a)]=this[_0x3a4527(0x15a)][_0x3a4527(0x166)](this);}static[_0x1ab6de(0x16d)](){const _0x550a92=_0x1ab6de;return this[_0x550a92(0x154)]||(this[_0x550a92(0x154)]=new Controller()),this['instance'];}async[_0x1ab6de(0x131)](){const _0x4bfab0=_0x1ab6de;Editor['User']['on'](_0x4bfab0(0x15d),this['onUserLogin']),Editor['User']['on'](_0x4bfab0(0x165),this[_0x4bfab0(0x12d)]),Editor[_0x4bfab0(0x14a)][_0x4bfab0(0x144)](_0x4bfab0(0x14b),this[_0x4bfab0(0x149)]),electron_1[_0x4bfab0(0x133)]['on'](namespace_1['ns']+':panel-ready',this[_0x4bfab0(0x15a)]),await Editor[_0x4bfab0(0x146)][_0x4bfab0(0x158)]()?this[_0x4bfab0(0x15c)]():(this['onNotLoggedInState'](),setTimeout(()=>{const _0x439f8b=_0x4bfab0;this[_0x439f8b(0x157)](!0x1);},0x1f4));}[_0x1ab6de(0x12c)](){const _0x174a0d=_0x1ab6de;Editor[_0x174a0d(0x146)]['removeListener']('login',this['onUserLogin']),Editor[_0x174a0d(0x146)]['removeListener'](_0x174a0d(0x165),this[_0x174a0d(0x12d)]),Editor[_0x174a0d(0x14a)][_0x174a0d(0x164)]('i18n:change',this[_0x174a0d(0x149)]),electron_1['ipcMain'][_0x174a0d(0x161)](namespace_1['ns']+_0x174a0d(0x12e),this[_0x174a0d(0x15a)]);}[_0x1ab6de(0x150)](){const _0x5a35cf=_0x1ab6de;newMsgCountTimer[_0x5a35cf(0x13f)](),update_toolbar_1[_0x5a35cf(0x130)]({'newMsgCount':0x0},!0x0),update_toolbar_1[_0x5a35cf(0x132)](!0x1);}[_0x1ab6de(0x16e)](){const _0x5b0e2e=_0x1ab6de;update_toolbar_1[_0x5b0e2e(0x132)](!0x0);}[_0x1ab6de(0x148)](){const _0x5094cd=_0x1ab6de;update_toolbar_1[_0x5094cd(0x132)](!0x0);}[_0x1ab6de(0x160)](){const _0x3b17cb=_0x1ab6de;this[_0x3b17cb(0x15c)]();}[_0x1ab6de(0x12d)](){const _0x317a71=_0x1ab6de;this[_0x317a71(0x137)]();}async[_0x1ab6de(0x149)](){const _0x626ece=_0x1ab6de;await Editor[_0x626ece(0x146)]['isLoggedIn']()&&this['dispatchLoggedInState']();}async[_0x1ab6de(0x15c)](){const _0x23133=_0x1ab6de,_0x1222c8=await service_1[_0x23133(0x14c)][_0x23133(0x16d)]();_0x1222c8['cleanImSetting'](),await _0x1222c8[_0x23133(0x13a)]()?this[_0x23133(0x16a)]():this[_0x23133(0x13e)]();}['onNotLoggedInState'](){const _0x2caddf=_0x1ab6de;Editor['Message'][_0x2caddf(0x135)](namespace_1['ns']+_0x2caddf(0x15b)),this[_0x2caddf(0x157)](!0x1),update_toolbar_1[_0x2caddf(0x130)]({'showToolbar':!0x1}),newMsgCountTimer[_0x2caddf(0x13f)]();}async[_0x1ab6de(0x16a)](){const _0x1f54f0=_0x1ab6de,_0x54f994=await service_1[_0x1f54f0(0x14c)]['getInstance'](),_0x39c92c=await _0x54f994[_0x1f54f0(0x139)](),_0x4075e5=await _0x54f994[_0x1f54f0(0x136)]();this[_0x1f54f0(0x157)](!0x0),update_toolbar_1[_0x1f54f0(0x130)]({'showToolbar':!0x0,'isVip':_0x39c92c,'buttonTitle':_0x4075e5}),newMsgCountTimer['setUp']();}[_0x1ab6de(0x13e)](){this['onNotLoggedInState']();}['onPanelReady'](_0x3c39af){const _0x357951=_0x1ab6de,_0x16617e=electron_1[_0x357951(0x14d)][_0x357951(0x145)](_0x3c39af[_0x357951(0x167)]);function _0x29262c(_0x566781){const _0x3ca1e7=_0x357951;_0x3c39af[_0x3ca1e7(0x167)][_0x3ca1e7(0x147)](namespace_1['ns']+_0x3ca1e7(0x14e),_0x566781);}_0x16617e?(_0x16617e['on'](_0x357951(0x15e),_0x29262c['bind'](null,_0x357951(0x15e))),_0x16617e['on']('focus',_0x29262c[_0x357951(0x166)](null,_0x357951(0x134))),_0x16617e['on'](_0x357951(0x13c),_0x29262c['bind'](null,_0x357951(0x13c))),_0x16617e['on'](_0x357951(0x142),_0x29262c[_0x357951(0x166)](null,_0x357951(0x142))),_0x16617e['on'](_0x357951(0x159),_0x29262c[_0x357951(0x166)](null,_0x357951(0x159))),_0x16617e['on'](_0x357951(0x169),_0x29262c[_0x357951(0x166)](null,_0x357951(0x169))),_0x16617e['on'](_0x357951(0x15e),()=>{update_toolbar_1['setPanelBlurred'](!0x0);}),_0x16617e['on'](_0x357951(0x134),()=>{const _0x5a8325=_0x357951;update_toolbar_1['updateToolbar']({'newMsgCount':0x0},!0x0),update_toolbar_1[_0x5a8325(0x132)](!0x1);})):console['error'](_0x357951(0x162));}['setMenuVisibility'](_0x27d82f){const _0x1945b7=_0x1ab6de;var _0x26c082;const _0x57a0a4=Editor[_0x1945b7(0x168)][_0x1945b7(0x14f)]({'name':namespace_1['ns']}),_0xcd3313=_0x57a0a4[_0x57a0a4[_0x1945b7(0x15f)]-0x1],_0x1670d9=_0xcd3313[_0x1945b7(0x151)],_0x59456a=null===(_0x26c082=_0xcd3313[_0x1945b7(0x156)][_0x1945b7(0x12f)])||void 0x0===_0x26c082?void 0x0:_0x26c082[_0x1945b7(0x163)][0x0];_0x59456a&&(_0x27d82f?Editor[_0x1945b7(0x152)][_0x1945b7(0x140)](_0x59456a[_0x1945b7(0x138)],Object[_0x1945b7(0x153)](Object[_0x1945b7(0x153)]({},_0x59456a),{'icon':path_1[_0x1945b7(0x14c)]['join'](__dirname,'../../resources/images/icon.png'),'click':()=>{Editor['Message']['send'](_0x1670d9,_0x59456a['message']);}})):Editor['Menu'][_0x1945b7(0x143)](_0x59456a[_0x1945b7(0x138)],_0x59456a),Editor[_0x1945b7(0x152)][_0x1945b7(0x13b)]());}}exports[_0x1ab6de(0x14c)]=Controller,Controller['instance']=null;